# {{ project_name }}

FastAPI service generated from [fastapi-skeleton-template](https://github.com/mkarots/fastapi-skeleton-template).

## Quick Start

1. **Install dependencies:**
   ```bash
   make sync
   # or
   uv sync --extra dev
   ```

2. **Set up environment variables:**
   ```bash
   cp .env.example .env
   # Edit .env with your configuration
   ```

3. **Run the development server:**
   ```bash
   make run
   # or
   uvicorn {{ package_name }}.main:app --reload
   ```

4. **Run tests:**
   ```bash
   make test
   # or
   pytest
   ```

5. **Lint and format:**
   ```bash
   make lint
   make fmt
   ```

## API Documentation

Once the server is running, visit:
- Swagger UI: http://localhost:8000/docs
- ReDoc: http://localhost:8000/redoc

## Health Check

```bash
curl http://localhost:8000/healthz
```

## Project Structure

```
{{ project_name }}/
├── {{ package_name }}/
│   ├── __init__.py
│   ├── api/          # API route definitions
│   │   └── routes.py
│   ├── service/      # Business logic
│   │   └── handlers.py
│   ├── infra/        # Infrastructure (db, logging, telemetry, middleware)
│   │   ├── db.py            # Database setup (if enabled)
│   │   ├── logging.py       # Logging configuration
│   │   ├── middleware.py    # Request/response middleware
│   │   └── telemetry.py     # Telemetry setup (if enabled)
│   ├── config.py     # Configuration management
│   ├── composition.py # Dependency injection
│   └── main.py       # Application entry point
├── tests/            # Test files
│   ├── test_api.py
│   └── test_service.py
├── .env.example      # Environment variables template
├── .gitignore        # Git ignore rules
├── Dockerfile        # Docker image definition
├── docker-compose.yml # Docker Compose configuration
├── makefile          # Common development commands
└── pyproject.toml    # Project dependencies
```

## Development

### Dependency Management

This project uses `uv` for dependency management. Lock files (`uv.lock`) should be committed to git for reproducible builds.

**Initial setup:**
```bash
uv sync --extra dev  # Installs dependencies and generates uv.lock
```

**When adding/updating dependencies:**
1. Edit `pyproject.toml`
2. Run `uv lock` to regenerate `uv.lock`
3. Commit both files to git

**For production builds:**
- Ensure `uv.lock` is committed
- Update Dockerfile to use `--frozen` flag (see Dockerfile comments)

### Running Tests

```bash
make test
```

### Code Quality

```bash
make lint   # Check for issues
make fmt    # Format code
```

## Docker

### Building and Running with Docker

**Build the Docker image:**
```bash
make docker-build
# or
docker build -t {{ project_name }}:latest .
```

**Run the container:**
```bash
make docker-run
# or
docker run -p 8000:8000 {{ project_name }}:latest
```

**Using Docker Compose (includes database if SQLAlchemy enabled):**
```bash
make docker-compose-up    # Start services
make docker-compose-logs  # View logs
make docker-compose-down  # Stop services
```

**Note:** For reproducible Docker builds, generate a lockfile first:
```bash
uv lock              # Generate uv.lock
git add uv.lock      # Commit to git
```

The Dockerfile uses `--frozen` mode which requires `uv.lock` to be present.

## Configuration

Configuration is managed through environment variables. See `.env.example` for available options.

## License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.
